# ResidueBEDMaker
Residue to nucleotide converter for the purpose of making BED files.

There is a [project out there](https://github.com/zwdzwd/transvar), called `transvar` that converts amino acid positions to nucleotide well, given a transcript.
However, this does not suit my needs. I want it to simply use the canonical transcript where the gene name matches.
This is dodgy as the canonical often differs between Ensembl, Uniprot and NCBI.

If an AA range spans one or more introns, the output will be two or more ranges. 

The reference is the genome as a GenBank file.

Technically, the residue range to gene can be used for other purposes.

**NB.** This has not been thoroughly tested and the offset between

# Sphinx autogenerated documentation

#### class ResidueBEDMaker.ResidueBEDMaker(genomefile: str)
Bases: `object`

A class to create a bed file given a bunch of residue annototations. See `.convert` for format of these.

One instance per BED file or `.reset` between new operations or the diagnositic will be wrong… no biggy if the data is clean.

The `convert` goes through the genome once to match and covert the annotations give and returns a list of str (BED file entries).

The `write_report` write the status report.

The genomefile is a large (4GB for humans) file containing the complete chromosomes.
BED instance reads the 4.3 GB genome data into memory when instantiated.
For humans these are: (save the list to a file and download them with BatchEntrez)

```
NC_000001.11
NC_000002.12
NC_000003.12
NC_000004.12
NC_000005.10
NC_000006.12
NC_000007.14
NC_000008.11
NC_000009.12
NC_000010.11
NC_000011.10
NC_000012.12
NC_000013.11
NC_000014.9
NC_000015.10
NC_000016.10
NC_000017.11
NC_000018.10
NC_000019.10
NC_000020.11
NC_000021.9
NC_000022.11
NC_000023.11
NC_000024.10
```


* **Parameters**

    **genomefile** (*str*) – The genome genbank.



### \__init__(genomefile: str)
The genomefile is a large (4GB for humans) file containing the complete chromosomes.
BED instance reads the 4.3 GB genome data into memory when instantiated.


* **Parameters**

    **genomefile** (*str*) – The genome genbank.



### convert(annotations)
Does the conversion of the annotations.


* **Parameters**

    **annotations** (*List**[**{gene: str**, **uniprot: int**, **x: int**, **y: int**, **name: str}**]*) – annotations of interest {gene: symbol, x: uniprot: acc, resi start, y: resi end (opt.), name: description}



* **Returns**

    bed_entries



### get_feature_aa(x, y, feat, seq)
Gets the translation of the genomic x and y, based on feat and genomic seq.


* **Parameters**

    
    * **x** – smallest postion


    * **y** – largest postion


    * **feat** (*FeatureLocation*) – 


    * **seq** – Bio Sequence obj.



* **Returns**

    Traslated extracted sequence. For validation.



* **Return type**

    str



### is_valid(feat, target, coordinates, chromosome)
This method checks whether all is good.


* **Parameters**

    
    * **feat** (*BioFeature*) – the genomic gene to use for the mapping


    * **target** – see annotations in convert


    * **coordinates** – a list of one or more coordinates in twos


    * **chromosome** – name for the bed file.



* **Returns**

    whether it is valid



* **Return type**

    bool



### reset()
diagnostic is an attribute that keep track of the errors. See `is_valid` method.


* **Returns**

    self



### resi_to_chr(from_resi, to_resi, feat)
Give a residue range and the cds location, give back the postions.
The positions are multiple of twos adn some regions may span exons.
No testing is done. is_valid does that.
location is a Location object from Bio.SeqRecord
The maths makes no sense. but seems to work well with forward.
Reverse is dodgy. So a reverse CompoundLocation has the exons in biological order
but each exon finishes with .start (smallest index) while .end is the actual start from the translational point of view.
the first value of a pair is the smallest coordinate. The sencond the largest. So in the case of a reverse strand,
the from_resi is the second, not the first.


### static show_feat(feat, diff=0)
Prints the Bio feature. for debug purposes.


### write_report(reportfile)
Writes the `.diagnostic` to file.


* **Parameters**

    **reportfile** (*str*) – filename for the report.



* **Returns**

    self


#### ResidueBEDMaker.test_fore()
A “test” that is not a unitest. that annotates a foreward multi-exon gene (TBL1Y) on the dinky Y chromosome (fast).

The user has to read the output to see if all is good.


#### ResidueBEDMaker.test_rev()
A “test” that is not a unitest. that annotates a reverse multi-exon gene (UTY) on the dinky Y chromosome (fast).

The user has to read the output to see if all is good.
